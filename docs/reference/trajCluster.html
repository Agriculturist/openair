<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate clusters for back tracectories — trajCluster â€¢ openair</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">openair</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidcarslaw/openair">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate clusters for back tracectories</h1>
    </div>

    
    <p>This function carries out cluster analysis of HYSPLIT back 
trajectories. The function is specifically designed to work with 
the trajectories imported using the <code>openair</code> 
<code>importTraj</code> function, which provides pre-calculated back 
trajectories at specific receptor locations.</p>
    

    <pre><span class='fu'>trajCluster</span>(<span class='no'>traj</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Euclid"</span>, <span class='kw'>n.cluster</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Set1"</span>, <span class='kw'>split.after</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>map.fill</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>map.cols</span> <span class='kw'>=</span> <span class='st'>"grey40"</span>, <span class='kw'>map.alpha</span> <span class='kw'>=</span> <span class='fl'>0.4</span>, <span class='kw'>projection</span> <span class='kw'>=</span> <span class='st'>"lambert"</span>,
  <span class='kw'>parameters</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>51</span>, <span class='fl'>51</span>), <span class='kw'>orientation</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>90</span>, <span class='fl'>0</span>, <span class='fl'>0</span>), <span class='kw'>by.type</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>origin</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>traj</dt>
      <dd>An openair trajectory data frame resulting from the 
use of <code>importTraj</code>.</dd>
      <dt>method</dt>
      <dd>Method used to calculate the distance matrix for the
back trajectories. There are two methods available:
&#8220;Euclid&#8221; and &#8220;Angle&#8221;.</dd>
      <dt>n.cluster</dt>
      <dd>Number of clusters to calculate.</dd>
      <dt>plot</dt>
      <dd>Should a plot be produced?</dd>
      <dt>type</dt>
      <dd><code>type</code> determines how the data are split i.e.
conditioned, and then plotted. The default is will produce a 
single plot using the entire data. Type can be one of the
built-in types as detailed in <code>cutData</code> e.g.
&#8220;season&#8221;, &#8220;year&#8221;, &#8220;weekday&#8221; and so on. For
example, <code>type = &quot;season&quot;</code> will produce four plots --- one
for each season. Note that the cluster calculations are
separately made of each level of &quot;type&quot;.</dd>
      <dt>cols</dt>
      <dd>Colours to be used for plotting. Options include 
&#8220;default&#8221;, &#8220;increment&#8221;, &#8220;heat&#8221;,
&#8220;jet&#8221; and <code>RColorBrewer</code> colours --- see the
<code>openair</code> <code>openColours</code> function for more details. For
user defined the user can supply a list of colour names
recognised by R (type <code>colours()</code> to see the full list). An
example would be <code>cols = c(&quot;yellow&quot;, &quot;green&quot;, &quot;blue&quot;)</code></dd>
      <dt>split.after</dt>
      <dd>For <code>type</code> other than &#8220;default&#8221; 
e.g. &#8220;season&#8221;, the trajectories can either be calculated
for each level of <code>type</code> independently or extracted after
the cluster calculations have been applied to the whole data
set.</dd>
      <dt>map.fill</dt>
      <dd>Should the base map be a filled polygon? Default 
is to fill countries.</dd>
      <dt>map.cols</dt>
      <dd>If <code>map.fill = TRUE</code> <code>map.cols</code> controls
the fill colour. Examples include <code>map.fill = &quot;grey40&quot;</code> and
<code>map.fill = openColours(&quot;default&quot;, 10)</code>. The latter colours
the countries and can help differentiate them.</dd>
      <dt>map.alpha</dt>
      <dd>The transpency level of the filled map which 
takes values from 0 (full transparency) to 1 (full opacity).
Setting it below 1 can help view trajectories, trajectory
surfaces etc. <em>and</em> a filled base map.</dd>
      <dt>projection</dt>
      <dd>The map projection to be used. Different map 
projections are possible through the <code>mapproj</code> package.
See<code>?mapproject</code> for extensive details and information on
setting other parameters and orientation (see below).</dd>
      <dt>parameters</dt>
      <dd>From the <code>mapproj</code> package. Optional 
numeric vector of parameters for use with the projection 
argument. This argument is optional only in the sense that
certain projections do not require additional parameters. If a
projection does require additional parameters, these must be
given in the parameters argument.</dd>
      <dt>orientation</dt>
      <dd>From the <code>mapproj</code> package. An optional 
vector c(latitude,longitude,rotation) which describes where the 
&quot;North Pole&quot; should be when computing the projection. Normally 
this is c(90,0), which is appropriate for cylindrical and conic 
projections. For a planar projection, you should set it to the 
desired point of tangency. The third value is a clockwise
rotation (in degrees), which defaults to the midrange of the
longitude coordinates in the map.</dd>
      <dt>by.type</dt>
      <dd>The percentage of the total number of trajectories
is given for all data by default. Setting <code>by.type = TRUE</code>
will make each panel add up to 100.</dd>
      <dt>origin</dt>
      <dd>If <code>TRUE</code> a filled circle dot is shown to mark the
receptor point.</dd>
      <dt>...</dt>
      <dd>Other graphical parameters passed onto 
<code>lattice:levelplot</code> and <code>cutData</code>. Similarly, common 
axis and title labelling options (such as <code>xlab</code>, 
<code>ylab</code>, <code>main</code>) are passed to <code>levelplot</code> via 
<code>quickText</code> to handle routine formatting.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list with two data components. The first
  (<code>data</code>) contains the orginal data with the cluster
  identified. The second (<code>results</code>) contains the data used
  to plot the clustered trajectories.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Two main methods are available to cluster the back trajectories 
using two different calculations of the distance matrix. The 
default is to use the standard Euclidian distance between each 
pair of trajectories. Also available is an angle-based distance 
matrix based on Sirois and Bottenheim (1995). The latter method is
useful when the interest is the direction of the trajectories in 
clustering.</p>
    <p>The distance matrix calculations are made in C++ for speed. For 
data sets of up to 1 year both methods should be relatively fast, 
although the <code>method = &quot;Angle&quot;</code> does tend to take much longer
to calculate. Further details of these methods are given in the 
openair manual.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sirois, A. and Bottenheim, J.W., 1995. Use of backward
trajectories to interpret the 5-year record of PAN and O3 ambient
air concentrations at Kejimkujik National Park, Nova
Scotia. Journal of Geophysical Research, 100: 2867-2881.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='importTraj.html'>importTraj</a></code>, <code><a href='trajPlot.html'>trajPlot</a></code>,
  <code><a href='trajLevel.html'>trajLevel</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Not run: ------------------------------------</span>
<span class='co'># ## import trajectories</span>
<span class='co'># traj &lt;- importTraj(site = "london", year = 2009)</span>
<span class='co'># ## calculate clusters</span>
<span class='co'># clust &lt;- trajCluster(traj, n.clusters = 5)</span>
<span class='co'># head(clust$data) ## note new variable 'cluster'</span>
<span class='co'># ## use different distance matrix calculation, and calculate by season</span>
<span class='co'># traj &lt;- trajCluster(traj, method = "Angle", type = "season", n.clusters = 4)</span>
<span class='co'>## ---------------------------------------------</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David Carslaw

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Carslaw, Karl Ropkins.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
